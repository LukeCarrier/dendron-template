---
id: FnK2ws6w1uaS1YzBUY3BR
title: GitHub Pages with GitHub Actions
desc: ''
updated: 1661799199882
created: 1631306630307
config:
  global:
    enableBackLinks: false
---

## Summary

Publishing Dendron using [GitHub Actions](https://docs.github.com/en/actions), by using [GitHub Actions for GitHub Pages](https://github.com/peaceiris/actions-gh-pages).

## Details

GitHub Actions help provide an automated form of publishing where your notes are published whenever a new commit is made to the `main` branch of your GitHub repository.

The generated site is also written to the `pages` branch of your repository, which keeps the published site contents separate from your `main` branch commit history.

## Prerequisites 

![[dendron://dendron.dendron-site/dendron.topic.publish.cook.github#prerequisites,1:#*]]

## Example Deployment

Looking for an easy button?

You can see a deployed example of these instructions in the following repository, **which can be used as a template** (recommended):

- [Dendron on GitHub Pages with GitHub Actions Template: `template.publish.github-action`](https://github.com/dendronhq/template.publish.github-action)
  - Make sure to select `Include all branches` when creating a new repository from this template.
  - The template, with every update, publishes to [this example website](https://dendronhq.github.io/template.publish.github-action/)

> You'll need to change both the `siteUrl` and `assetsPrefix` fields in `dendron.yml` to your own location, unless you are planning to go with a [[custom domain name|dendron://dendron.dendron-site/dendron.topic.publish.cook.github-with-custom-domain]]

## Steps

### 1. Create a GitHub repo

> NOTE: The following directions assume you aren't using the example deployment template which can be autogenerated from the repository. If you are using the template, move forward to [[Enable GitHub Pages|dendron://dendron.dendron-site/dendron.topic.publish.cook.github-action#enable-github-pages]].

Follow the instructions [here](https://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-new-repository) to create a repository. 

![[dendron.topic.publish.cook.github#add-your-notes:#turn-on-github-pages]]

### 2. Setup Publishing

![[dendron://dendron.dendron-site/dendron.topic.publish.cook.github#setup-dendron-nextjs-publishing,1:#publish-your-notes]]

### 3. Setup GitHub Pages

- Create a pages branch
  ```sh
  git checkout -b pages
  git push -u origin HEAD
  ```

#### Enable GitHub Pages

- Turn on GitHub Pages for the `pages` branch
  - Follow the [Choosing a publishing source](https://docs.github.com/en/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site) GitHub documentation with:
    - `pages` branch
    - `/ (root)` folder

### 4. Setup GitHub Actions

1. Switch back to your main branch
  ```sh
  git checkout main
  ```
1. Create a workflow
  - mac and linux
    ```sh
    mkdir -p .github/workflows
    touch .github/workflows/publish.yml
    ```
  - windows
  ```powershell
  mkdir -p .github/workflows
  New-Item .github/workflows/publish.yml
  ```

1. Setup workflow
  ```yml
  name: Build Dendron Static Site

  on:
    workflow_dispatch: # Enables on-demand/manual triggering
    push:
      branches:
      - main

  jobs:
    build:
      runs-on: ubuntu-latest
      steps:
      - name: Checkout source
        uses: actions/checkout@v2
        with:
          fetch-depth: 0

      - name: Restore Node modules cache
        uses: actions/cache@v2
        id: node-modules-cache
        with:
          path: |
            node_modules
            .next/*
            !.next/.next/cache
            !.next/.env.*
          key: ${{ runner.os }}-dendronv2-${{ hashFiles('**/yarn.lock', '**/package-lock.json') }}

      - name: Install dependencies
        run: yarn

      - name: Initialize or pull nextjs template
        run: "(test -d .next) && (echo 'updating dendron next...' && cd .next && git reset --hard && git pull && yarn && cd ..) || (echo 'init dendron next' && yarn dendron publish init)"

      - name: Restore Next cache
        uses: actions/cache@v2
        with:
          path: .next/.next/cache
          # Generate a new cache whenever packages or source files change.
          key: ${{ runner.os }}-nextjs-${{ hashFiles('.next/yarn.lock', '.next/package-lock.json') }}-${{ hashFiles('.next/**.[jt]s', '.next/**.[jt]sx') }}

      - name: Export notes
        run: yarn dendron publish export --target github --yes

      - name: Deploy site
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_branch: pages
          publish_dir: docs/
          force_orphan: true
          #cname: example.com
  ```

1. Commit your changes
  ```sh
  git add .
  git commit -m "add workflow"
  git push
  ```

- NOTE: if you are interested in what exactly the github action script is doing, see [[Action Detail|dendron://dendron.dendron-site/dendron.topic.publish.cook.github-action.action-detail]]

### 5. First Deployments

![[dendron://dendron.dendron-site/dendron.topic.publish.cook.github#first-deployments,1:#*]]

## Upgrading

![[dendron://dendron.dendron-site/dendron.topic.publish.cook.common#upgrading,1:#*]]

## Next Steps

- Review and further customize your [[Publishing Configurations|dendron://dendron.dendron-site/dendron.topic.publish.config]] as needed.
- If you intend for your published site to be publicly viewable, make sure to add it to the [`awesome-dendron`](https://github.com/dendronhq/awesome-dendron/) repo so that the community can see your digital garden.

## Congratulations, you just published your first note ðŸŒ±